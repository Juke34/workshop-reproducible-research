<!DOCTYPE html>
<html lang="en">
	<head>
		
		
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<meta name="author" content="Jacques Dainat et al.">
		<link rel="canonical" href="https://Juke34.github.io/workshop-reproducible-research/jupyter/jupyter-4-plotting/">
		<link rel="shortcut icon" href="../../img/favicon.ico">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
		<title>Plotting - Bioinformatics Workshop on Tools for Reproducible Research</title>
		<link href="../../bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
		<link href="../../css/font-awesome-5.12.2-all.min.css" rel="stylesheet">
		<link href="../../css/base.css" rel="stylesheet">
		<link rel="stylesheet" href="../../css/highlight-github.css">
		<script src="../../bootstrap/dist/js/bootstrap.min.js"></script>
		<script src="../../js/highlight.pack.js"></script>
		
		<script>
			var base_url = '../..';
			var home_url = '../../usage';
			var is_outer_page = false;
			
			var pageToc = [
				{title: "Other packages for plotting", url: "#_top", children: [
				]},
			];

		</script>
		<script src="../../js/base.js"></script> 
	</head>

	<body class="inner-page">
		

		<div class="container-fluid wm-page-content">
			<a name="_top" aria-hidden="true"></a>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../jupyter-3-magics/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../jupyter-3-magics/" class="btn btn-sm btn-link">
			Magics
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../jupyter-5-widgets/" class="btn btn-sm btn-link">
			Widgets
		</a>
		<a href="../jupyter-5-widgets/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			

			<p>An essential feature of Jupyter Notebooks is of course the ability to visualize
data and results via plots. A full guide to plotting in Python is beyond the 
scope of this course, but we'll offer a few glimpses into the plotting landscape
of Python.</p>
<p>First of all, Python has a library for plotting called
<a href="https://matplotlib.org/stable/index.html">matplotlib</a>, which comes packed with 
functionality for creating high-quality plots. Below is an example of how to 
generate a line plot of a sine wave.</p>
<pre><code class="language-python"># Import packages
import numpy as np
import matplotlib.pyplot as plt
# Generate a set of evenly spaced numbers between 0 and 100 
x = np.linspace(0,3*np.pi,100)
# Use the sine function to generate y-values
y = np.sin(x)
# Plot the data
line, = plt.plot(x, y, color='red', linestyle=&quot;-&quot;)
</code></pre>
<p>By default plots are rendered in the notebook as rasterized images which can 
make the quality poor. To render in scalable vector graphics format use the 
<code>set_matplotlib_formats</code> from the matplotlib_inline package:</p>
<pre><code class="language-python">import matplotlib_inline
matplotlib_inline.backend_inline.set_matplotlib_formats('pdf', 'svg')
</code></pre>
<p>Now try running the code for the sine wave plot again.</p>
<h2 id="other-packages-for-plotting">Other packages for plotting<a class="headerlink" href="#other-packages-for-plotting" title="Permanent link">#</a></h2>
<p>As we mentioned Matplotlib comes with <strong>a lot</strong> of functionality which is great
because it allows you to create all sorts of plots and modify them exactly to 
your liking. However, this can also mean that creating very basic plots might 
involve a lot of cumbersome coding, when all you want is a simple bar chart!</p>
<p>Fortunately there are a number of Python packages that build upon matplotlib but 
with a much simplified interface. One such popular package is 
<a href="http://seaborn.pydata.org/">seaborn</a>. Below we'll see how to generate a nice 
looking bar plot with error bars.</p>
<p>First import the seaborn package (using an abbreviated name to simplify typing):</p>
<pre><code class="language-python">import seaborn as sns
</code></pre>
<p>Next we'll load some example data of penguins collected at the Palmer Station, 
in Antarctica.</p>
<pre><code class="language-python">penguins = sns.load_dataset(&quot;penguins&quot;)
# Look at first 5 lines of the data
penguins.head(5)
</code></pre>
<p>The most basic way to generate a bar plot of this data with seaborn is:</p>
<pre><code class="language-python">sns.barplot(data=penguins)
</code></pre>
<p>Simple right? Yes, but maybe not very informative. Here seaborn simply 
calculates the mean of all numeric variables for the penguins and plots them 
with error bars representing a 95% confidence interval.</p>
<p>Let's say that instead we want to plot the mean value of the body mass of the
penguins at the different islands where they were examined.</p>
<pre><code>sns.barplot(data=penguins, x=&quot;island&quot;, y=&quot;body_mass_g&quot;, ci=&quot;sd&quot;, errwidth=.5);
</code></pre>
<p>Here we specified to use values in the 'island' column as categories for the 
x-axis, and values in the 'body_mass_g' column as values for the y-axis. 
The barplot function of seaborn will then calculate the mean body mass for each
island and plot the bars. With <code>ci="sd"</code> we tell the function to draw the 
standard deviation as error bars, instead of computing a confidence interval. 
Finally <code>errwidth=.5</code> sets the linewidth of the error bars.</p>
<p>If we instead want to visualize the data as a scatterplot we can use the 
<code>sns.scatterplot</code> function. Let's plot the body mass vs. bill length for all
penguins and color the data points by species. We'll also move the legend 
outside of the plotting area and modify the x and y-axis labels:</p>
<pre><code class="language-python"># Store the matplotlib axes containing the plot in a variable called 'ax'
ax = sns.scatterplot(data=penguins, x=&quot;bill_length_mm&quot;, y=&quot;body_mass_g&quot;, 
                     hue=&quot;species&quot;)
# Modify the labels of the plot
ax.set_xlabel(&quot;Bill length (mm)&quot;)
ax.set_ylabel(&quot;Body mass (g)&quot;)
# Set legend position outside of plot
ax.legend(bbox_to_anchor=(1,1));
</code></pre>
<p>If you want to save a plot to file you can use the <code>plt.savefig</code> function. Add
the following to the bottom of the cell with the scatterplot code:</p>
<pre><code class="language-python">plt.savefig(&quot;scatterplot.pdf&quot;, bbox_inches=&quot;tight&quot;)
</code></pre>
<p>The <code>bbox_inches="tight"</code> setting ensures that the figure is not clipped when
saved to file.</p>
<p>The Seaborn <a href="http://seaborn.pydata.org/">website</a> contains great tutorials and
examples of other ways to plot data!</p>
<blockquote>
<p><strong>Quick recap</strong> <br>
In this section we've learned:</p>
<ul>
<li>How to generate simple plots with <code>matplotlib</code></li>
<li>How to import and use the <code>seaborn</code> package for plotting</li>
<li>How to save plots from notebooks to a file</li>
</ul>
</blockquote>

			<br>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../jupyter-3-magics/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../jupyter-3-magics/" class="btn btn-sm btn-link">
			Magics
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../jupyter-5-widgets/" class="btn btn-sm btn-link">
			Widgets
		</a>
		<a href="../jupyter-5-widgets/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			<br>
		</div>

		<footer class="container-fluid wm-page-content text-center small">
			<p>
			<a href="https://github.com/Juke34/workshop-reproducible-research/edit/master/docs/jupyter/jupyter-4-plotting.md" target="_blank">Edit on workshop-reproducible-research</a>
			</p>
			<details>
				<summary>
					Documentation built with <a href="http://www.mkdocs.org/" target="_blank">MkDocs</a> using  <a href="https://github.com/Siphalor/mkdocs-custommill" target="_blank">CustomMill</a>.
				</summary>
				<h6 class="mt-2">Additional Licenses</h6>
				<ul><li>
						CustomMill is based on the <a href="https://github.com/gristlabs/mkdocs-windmill" target="_blank">Windmill</a> theme by Grist Labs, licensed under the <a href="https://github.com/gristlabs/mkdocs-windmill/blob/master/LICENSE" target="_blank">MIT License</a>
					</li>
					<li>
						CustomMill includes <a href="https://getbootstrap.com" target="_blank">Bootstrap</a> version 5.1.3. This is available under the <a href="https://github.com/twbs/bootstrap/blob/master/LICENSE" target="_blank">MIT License</a>.
					</li>
					<li>
						Syntax highlighting is implemented via <a href="https://highlightjs.org" target="_blank">highlight.js</a> licensed under the BSD 3-Clause License and the included github styling made by Vasily Polovnyov.
					</li>
					<li>
						Icons on this site are from <a href="https://fontawesome.com/" target="_blank">Font Awesome</a> which is licensed under the <a href="https://fontawesome.com/license/free" target="_blank">Font Awesome Free License</a>.
					</li></ul>
				<p>Built at 2023-02-10 16:41:13 UTC</p>
			</details>
		</footer>

		
	</body>
</html>