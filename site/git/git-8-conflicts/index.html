<!DOCTYPE html>
<html lang="en">
	<head>
		
		
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<meta name="author" content="Jacques Dainat et al.">
		<link rel="canonical" href="https://Juke34.github.io/workshop-reproducible-research/git/git-8-conflicts/">
		<link rel="shortcut icon" href="../../img/favicon.ico">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
		<title>Conflict - Bioinformatics Workshop on Tools for Reproducible Research</title>
		<link href="../../bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
		<link href="../../css/font-awesome-5.12.2-all.min.css" rel="stylesheet">
		<link href="../../css/base.css" rel="stylesheet">
		<link rel="stylesheet" href="../../css/highlight-github.css">
		<script src="../../bootstrap/dist/js/bootstrap.min.js"></script>
		<script src="../../js/highlight.pack.js"></script>
		
		<script>
			var base_url = '../..';
			var home_url = '../../usage';
			var is_outer_page = false;
			
			var pageToc = [
			];

		</script>
		<script src="../../js/base.js"></script> 
	</head>

	<body class="inner-page">
		

		<div class="container-fluid wm-page-content">
			<a name="_top" aria-hidden="true"></a>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../git-7-working-remotely/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../git-7-working-remotely/" class="btn btn-sm btn-link">
			Working remotly
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../git-9-extra-material/" class="btn btn-sm btn-link">
			Extra material
		</a>
		<a href="../git-9-extra-material/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			

			<p>It is not uncommon to run into conflicts when you are trying to merge separate
branches, and it's even more common when you're working in a collaborative
setting with remote repositories. It'll happen sooner or later, even if you're
only working locally, so it's important to know how to deal with them! We'll
now introduce a conflict on purpose, which we can then solve.</p>
<ul>
<li>Remember that we have two separate local copies of the same repository? Let's
  go into the first one, <code>git_tutorial</code>, and change the MultiQC version in the
  <code>environment.yml</code> file:</li>
</ul>
<pre><code class="language-yaml">multiqc=1.8
</code></pre>
<ul>
<li>Add, commit and push your change to the remote.</li>
</ul>
<p>Now we have a change in our remote and <em>one</em> of our local copies, but not in the
other. This could happen if a collaborator of yours committed a change and
pushed it to GitHub. Let's create a conflict!</p>
<ul>
<li>
<p>Move into your other local repository, <code>git_remote_tutorial</code>, which doesn't
  have the new change. Run <code>git status</code>. Notice that Git says: "<em>Your branch is
  up-to-date with 'origin/main'.</em>". We know that this is not true, but this
  local clone is not yet aware of the remote changes.</p>
</li>
<li>
<p>Let's change the <code>environment.yml</code> file in this local repository as well, but
  to version 1.6, instead! It may be the case that your collaborator thought it
  was good to use MultiQC version 1.8, whereas you thought it would be better to
  use MultiQC version 1.6, but neither of you communicated that to the other.</p>
</li>
<li>
<p>Add and commit your change and try to push the commit, which should give you
  an error message that looks like this:</p>
</li>
</ul>
<pre><code class="language-no-highlight"> ! [rejected]        main -&gt; main (fetch first)
error: failed to push some refs to 'https://github.com/user/git_tutorial.git'
hint: Updates were rejected because the remote contains work that you do
hint: not have locally. This is usually caused by another repository pushing
hint: to the same ref. You may want to first integrate the remote changes
hint: (e.g., 'git pull ...') before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details.
</code></pre>
<p>This error message is thankfully quite informative in regards to what is going
on and what might be done about it. In essence it will not allow you to push
to the remote since there are conflicting changes made to it.</p>
<ul>
<li>Let's download the changes made to the remote, but without trying to merge
  them directly. This can be done using the following command:</li>
</ul>
<pre><code class="language-bash">git fetch
</code></pre>
<blockquote>
<p><strong>Note</strong> <br>
The <code>fetch</code> command is very similar to <code>pull</code> in that it downloads remote
changes that are not present locally, but differs in that it doesn't try to
merge them locally; <code>pull</code> both downloads and merges (unless there's
a conflict, in which case it will tell you so and raise an error like the
one above). You can thus skip <code>fetch</code> and just do <code>pull</code> straight away, if
you prefer.</p>
</blockquote>
<ul>
<li>
<p>Now run <code>git status</code>. Unlike before, our local Git clone now is aware of the
  latest changes pushed to the remote. It will tell you something along the
  lines: "<em>Your branch and 'origin/main' have diverged, and have 1 and
  1 different commit each, respectively.</em>".</p>
</li>
<li>
<p>We can now run the following to see what the difference is between the current
  state of our local clone and the <code>main</code> branch on the remote origin:</p>
</li>
</ul>
<pre><code class="language-bash">git diff origin/main
</code></pre>
<ul>
<li>Now let's try to integrate the remote changes with our local changes and get
  up to sync with the remote:</li>
</ul>
<pre><code class="language-bash">git merge
</code></pre>
<p>Unsurprisingly, the <code>git merge</code> command resulted in a conflict. Git tells us
about this and suggests that we should fix the conflicts and commit that.</p>
<ul>
<li>As always, run <code>git status</code> to get an overview: you will see that you have
  so-called unmerged paths and that the conflicting file is <code>environment.yml</code>,
  since both modified the same line in this file. To fix a conflict, open the
  affected file in a text editor. You will see that it now looks something like
  this:</li>
</ul>
<pre><code class="language-no-highlight">channels:
  - conda-forge
  - bioconda
  - main
  - r
dependencies:
  - python=3.9.12
  - fastqc=0.11.9
  - sra-tools=2.10.1
  - snakemake=7.3.8
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
  - multiqc=1.6
=======
  - multiqc=1.8
&gt;&gt;&gt;&gt;&gt;&gt;&gt; refs/remotes/origin/main
  - bowtie2=2.4.5
  - tbb=2020.2
  - samtools=1.15.1
  - subread=2.0.1
  - bedtools=2.29.2
  - wget=1.20.3
  - graphviz=3.0.0
  - r-base=4.1.3
  - r-ggplot2=3.3.5
  - r-reshape2=1.4.4
  - r-stringi=1.7.6
  - r-pheatmap=1.0.12
  - r-rmarkdown=2.13
  - r-r.utils=2.11.0
  - bioconductor-rtracklayer=1.54.0
  - bioconductor-geoquery=2.62.0
  - xorg-libxrender
  - xorg-libxpm
</code></pre>
<p>The part between <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</code> and <code>=======</code> is your local version, and the
part between <code>=======</code> and <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt; refs/remotes/origin/main</code> is
the one added to the remote and which caused the conflict when you tried to merge
those changes to your local repository. It is now up to you to decide which 
version to keep, or to change it to a third alternative.</p>
<ul>
<li>Let's say that you are confident that it is better to run MultiQC 1.6 rather
  than 1.8. Edit the file so that it looks like you want it to, <em>i.e.</em> remove
  the lines added by Git and delete the line with <code>multiqc=1.8</code>. The final file
  should look like this:</li>
</ul>
<pre><code class="language-no-highlight">channels:
  - conda-forge
  - bioconda
  - main
  - r
dependencies:
  - python=3.9.12
  - fastqc=0.11.9
  - sra-tools=2.10.1
  - snakemake=7.3.8
  - multiqc=1.6
  - bowtie2=2.4.5
  - tbb=2020.2
  - samtools=1.15.1
  - subread=2.0.1
  - bedtools=2.29.2
  - wget=1.20.3
  - graphviz=3.0.0
  - r-base=4.1.3
  - r-ggplot2=3.3.5
  - r-reshape2=1.4.4
  - r-stringi=1.7.6
  - r-pheatmap=1.0.12
  - r-rmarkdown=2.13
  - r-r.utils=2.11.0
  - bioconductor-rtracklayer=1.54.0
  - bioconductor-geoquery=2.62.0
  - xorg-libxrender
  - xorg-libxpm
</code></pre>
<ul>
<li>Run <code>git status</code> again. Notice that it says <code>use "git add &lt;file&gt;..." to mark
  resolution</code>? Let's do that!</li>
</ul>
<pre><code class="language-bash">git add environment.yml
</code></pre>
<ul>
<li>Run <code>git status</code> again! It will now tell us: <code>All conflicts fixed but you are
  still merging. (use "git commit" to conclude merge)</code>. So, you probably
  guessed it, run:</li>
</ul>
<pre><code class="language-bash">git commit -m &quot;Merge and set multiqc to v1.6&quot;
</code></pre>
<ul>
<li>Finally, push these changes to GitHub:</li>
</ul>
<pre><code class="language-bash">git push
</code></pre>
<ul>
<li>Go to GitHub in the browser and click the commit tracker again. You will see
  a list of commits including where MultiQC was first changed to version <code>1.7</code>
  from our previous work, then to <code>1.8</code>, <code>1.6</code> and, finally, followed by a merge
  where the version was set to <code>1.6</code>.</li>
</ul>
<blockquote>
<p><strong>Note</strong> <br>
While the example we've used here is from a collaborative setting, conflicts
also arise when you are working alone. They usually happen when you have
several feature branches that you want to merge into <code>main</code> and you've
forgot to keep all branches up-to-date with each other.</p>
<p><strong>Quick recap</strong> <br>
We learned about how conflicting commits can happen and how to deal with
them by inspecting the affected files and looking for the source of the
conflict.</p>
</blockquote>

			<br>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../git-7-working-remotely/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../git-7-working-remotely/" class="btn btn-sm btn-link">
			Working remotly
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../git-9-extra-material/" class="btn btn-sm btn-link">
			Extra material
		</a>
		<a href="../git-9-extra-material/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			<br>
		</div>

		<footer class="container-fluid wm-page-content text-center small">
			<p>
			<a href="https://github.com/Juke34/workshop-reproducible-research/edit/master/docs/git/git-8-conflicts.md" target="_blank">Edit on workshop-reproducible-research</a>
			</p>
			<details>
				<summary>
					Documentation built with <a href="http://www.mkdocs.org/" target="_blank">MkDocs</a> using  <a href="https://github.com/Siphalor/mkdocs-custommill" target="_blank">CustomMill</a>.
				</summary>
				<h6 class="mt-2">Additional Licenses</h6>
				<ul><li>
						CustomMill is based on the <a href="https://github.com/gristlabs/mkdocs-windmill" target="_blank">Windmill</a> theme by Grist Labs, licensed under the <a href="https://github.com/gristlabs/mkdocs-windmill/blob/master/LICENSE" target="_blank">MIT License</a>
					</li>
					<li>
						CustomMill includes <a href="https://getbootstrap.com" target="_blank">Bootstrap</a> version 5.1.3. This is available under the <a href="https://github.com/twbs/bootstrap/blob/master/LICENSE" target="_blank">MIT License</a>.
					</li>
					<li>
						Syntax highlighting is implemented via <a href="https://highlightjs.org" target="_blank">highlight.js</a> licensed under the BSD 3-Clause License and the included github styling made by Vasily Polovnyov.
					</li>
					<li>
						Icons on this site are from <a href="https://fontawesome.com/" target="_blank">Font Awesome</a> which is licensed under the <a href="https://fontawesome.com/license/free" target="_blank">Font Awesome Free License</a>.
					</li></ul>
				<p>Built at 2023-02-10 16:41:13 UTC</p>
			</details>
		</footer>

		
	</body>
</html>