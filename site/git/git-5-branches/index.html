<!DOCTYPE html>
<html lang="en">
	<head>
		
		
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<meta name="author" content="Jacques Dainat et al.">
		<link rel="canonical" href="https://Juke34.github.io/workshop-reproducible-research/git/git-5-branches/">
		<link rel="shortcut icon" href="../../img/favicon.ico">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
		<title>Branching and merging - Bioinformatics Workshop on Tools for Reproducible Research</title>
		<link href="../../bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
		<link href="../../css/font-awesome-5.12.2-all.min.css" rel="stylesheet">
		<link href="../../css/base.css" rel="stylesheet">
		<link rel="stylesheet" href="../../css/highlight-github.css">
		<script src="../../bootstrap/dist/js/bootstrap.min.js"></script>
		<script src="../../js/highlight.pack.js"></script>
		
		<script>
			var base_url = '../..';
			var home_url = '../../usage';
			var is_outer_page = false;
			
			var pageToc = [
			];

		</script>
		<script src="../../js/base.js"></script> 
	</head>

	<body class="inner-page">
		

		<div class="container-fluid wm-page-content">
			<a name="_top" aria-hidden="true"></a>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../git-4-ignoring-files/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../git-4-ignoring-files/" class="btn btn-sm btn-link">
			Ignoring files
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../git-6-tags/" class="btn btn-sm btn-link">
			Tagging commits
		</a>
		<a href="../git-6-tags/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			

			<p>One of the most useful features of Git is called <em>branching</em>. Branching allows
you to diverge from the main line of work and edit or update your code and
files (<em>e.g.</em> to test out a new analysis or some experimental feature) without
affecting your main work. If the work you did in the branch turns out to be
useful you can merge that back into your <code>main</code> branch. On the other hand, if
the work didn't turn out as planned, you can simply delete the branch and
continue where you left off in your main line of work. Another use case for
branching is when you are working in a project with multiple people. Branching
can be a way of compartmentalizing your team's work on different parts of the
project and enables merging back into the <code>main</code> branch in a controlled
fashion; we will learn more about this in the section about working remotely.</p>
<ul>
<li>Let's start trying out branching! We can see the current branch by running:</li>
</ul>
<pre><code class="language-bash">git branch
</code></pre>
<p>This tells us that there is only the <code>main</code> branch at the moment.</p>
<blockquote>
<p><strong>Main and Master</strong> <br>
If your branch is called <code>master</code> instead of <code>main</code> that's perfectly fine as
well, but do check out the Git section of the <a href="pre-course-setup">pre-course setup</a>
for more details about the choice of default branch names.</p>
</blockquote>
<ul>
<li>Let's make a new branch:</li>
</ul>
<pre><code class="language-bash">git branch test_alignment
</code></pre>
<ul>
<li>
<p>Run <code>git branch</code> again to see the available branches. Do you note which one
  is selected as the active branch?</p>
</li>
<li>
<p>Let's move to our newly created branch using the <code>checkout</code> command:</p>
</li>
</ul>
<pre><code class="language-bash">git checkout test_alignment
</code></pre>
<blockquote>
<p><strong>Tip</strong> <br>
You can create and checkout a new branch in one line with <code>git checkout -b
branch_name</code>.</p>
</blockquote>
<p>Let's add some changes to our new branch! We'll use this to try out a different
set of parameters on the sequence alignment step of the case study project.</p>
<ul>
<li>Edit the <code>Snakefile</code> so that the shell command of the <code>align_to_genome</code> rule
  looks like this (add the <code>--very-sensitive-local</code> option):</li>
</ul>
<pre><code class="language-bash">bowtie2 --very-sensitive-local -x $indexBase -U {input.fastq} &gt; {output} 2&gt; {log}
</code></pre>
<ul>
<li>
<p>Add and commit the change!</p>
</li>
<li>
<p>To get a visual view of your branches and commits you can use the command:</p>
</li>
</ul>
<pre><code class="language-bash">git log --graph --all --oneline
</code></pre>
<p>It is often useful to see what differences exist between branches.
You can use the <code>diff</code> command for this:</p>
<pre><code class="language-bash">git diff main
</code></pre>
<p>This shows the difference between the active branch (<code>test_alignment</code>) and
<code>main</code> on a line-per-line basis. Do you see which lines have changed between
<code>test_alignment</code> and <code>main</code> branches?</p>
<blockquote>
<p><strong>Tip</strong> <br>
We can also add the <code>--color-words</code> flag to <code>git diff</code>, which instead
displays the difference on a word-per-word basis rather than line-per-line.</p>
<p><strong>Note</strong> <br>
Git is constantly evolving, along with some of its commands. While the
<code>checkout</code> command is quite versatile (it's used for more than just switching
branches), this versatility can sometimes be confusing. The Git team thus
added a new command, <code>git switch</code>, that can be used instead. This command is
still experimental, however, so we have opted to stick with <code>checkout</code> for
the course - for now.</p>
</blockquote>
<p>Now, let's assume that we have tested our code and the alignment analysis is run
successfully with our new parameters. We thus want to merge our work into the
<code>main</code> branch. It is good to start with checking the differences between
branches (as we just did) so that we know what we will merge.</p>
<ul>
<li>Checkout the branch you want to merge into, <em>i.e.</em> <code>main</code>:</li>
</ul>
<pre><code class="language-bash">git checkout main
</code></pre>
<ul>
<li>To merge, run the following code:</li>
</ul>
<pre><code class="language-bash">git merge test_alignment
</code></pre>
<p>Run <code>git log --graph --all --oneline</code> again to see how the merge commit brings
back the changes made in <code>test_alignment</code> to <code>main</code>.</p>
<blockquote>
<p><strong>Tip</strong> <br>
If working on different features or parts of an analysis on different
branches, and at the same time maintaining a working <code>main</code> branch for the
stable code, it is convenient to periodically merge the changes made to
<code>main</code> into relevant branches (<em>i.e.</em> the opposite to what we did above).
That way, you keep your experimental branches up-to-date with the newest
changes and make them easier to merge into <code>main</code> when time comes.</p>
</blockquote>
<ul>
<li>If we do not want to do more work in <code>test_alignment</code> we can delete that
  branch:</li>
</ul>
<pre><code class="language-bash">git branch -d test_alignment
</code></pre>
<ul>
<li>Run <code>git log --graph --all --oneline</code> again. Note that the commits and
  the graph history are still there? A branch is simply a pointer to a
  specific commit, and that pointer has been removed.</li>
</ul>
<blockquote>
<p><strong>Tip</strong> <br>
There are many types of so-called "branching models", each with varying
degrees of complexity depending on the developer's needs and the number of
collaborators. While there certainly isn't a single branching model that
can be considered to be the "best", it is very often most useful to keep it
simple. An example of a simple and functional model is to have a <code>main</code>
branch that is always working (<em>i.e.</em> can successfully run all your code
and without known bugs) and develop new code on feature branches (one new
feature per branch). Feature branches are short-lived, meaning that they
are deleted once they are merged into <code>main</code>.</p>
<p><strong>Quick recap</strong> <br>
We have now learned how to divide our work into branches and how to manage
them:</p>
<ul>
<li><code>git branch &lt;branch&gt;</code> creates a new branch.</li>
<li><code>git checkout &lt;branch&gt;</code> moves the repository to the state in which the
  specified branch is currently in.</li>
<li><code>git merge &lt;branch&gt;</code> merges the specified branch into the current one.</li>
</ul>
</blockquote>

			<br>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../git-4-ignoring-files/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../git-4-ignoring-files/" class="btn btn-sm btn-link">
			Ignoring files
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../git-6-tags/" class="btn btn-sm btn-link">
			Tagging commits
		</a>
		<a href="../git-6-tags/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			<br>
		</div>

		<footer class="container-fluid wm-page-content text-center small">
			<p>
			<a href="https://github.com/Juke34/workshop-reproducible-research/edit/master/docs/git/git-5-branches.md" target="_blank">Edit on workshop-reproducible-research</a>
			</p>
			<details>
				<summary>
					Documentation built with <a href="http://www.mkdocs.org/" target="_blank">MkDocs</a> using  <a href="https://github.com/Siphalor/mkdocs-custommill" target="_blank">CustomMill</a>.
				</summary>
				<h6 class="mt-2">Additional Licenses</h6>
				<ul><li>
						CustomMill is based on the <a href="https://github.com/gristlabs/mkdocs-windmill" target="_blank">Windmill</a> theme by Grist Labs, licensed under the <a href="https://github.com/gristlabs/mkdocs-windmill/blob/master/LICENSE" target="_blank">MIT License</a>
					</li>
					<li>
						CustomMill includes <a href="https://getbootstrap.com" target="_blank">Bootstrap</a> version 5.1.3. This is available under the <a href="https://github.com/twbs/bootstrap/blob/master/LICENSE" target="_blank">MIT License</a>.
					</li>
					<li>
						Syntax highlighting is implemented via <a href="https://highlightjs.org" target="_blank">highlight.js</a> licensed under the BSD 3-Clause License and the included github styling made by Vasily Polovnyov.
					</li>
					<li>
						Icons on this site are from <a href="https://fontawesome.com/" target="_blank">Font Awesome</a> which is licensed under the <a href="https://fontawesome.com/license/free" target="_blank">Font Awesome Free License</a>.
					</li></ul>
				<p>Built at 2023-02-10 16:41:13 UTC</p>
			</details>
		</footer>

		
	</body>
</html>